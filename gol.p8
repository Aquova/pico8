pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- game of life
-- by aquova

function _init()
	t=0
	size=64
	screen=128
	blocksize=screen/size
	grid=creategrid()
	col1=7
	col2=0
	cur={x=size/2,y=size/2}
	menu_ptr=0
	-- states:
	-- 0 - menu
	-- 1 - main
	-- 2 - level draw
	state=0
end

function centertext(_t)
	return (screen/2)-#_t*2
end

function titlescreen()
	cls(col1)
 local title="conway's game of life"
	print(title,centertext(title),30,col2)
 local author="by aquova"
	print(author,centertext(author),42,col2)

 local menu1="begin with random pattern"
 local menu2="pattern creator"
 local menu3="foreground color"
 local menu4="background color"
	print(menu1,20,64,col2)
	print(menu2,20,70,col2)
	print(menu3,20,76,col2)
	print(menu4,20,82,col2)

	if t%30<15 then	
		if menu_ptr < 2 then
			print(">",15,64+menu_ptr*6,col2)
	 else
 		print("<",15,64+menu_ptr*6,col2)
 		print(">",85,64+menu_ptr*6,col2)
		end
	end
	
	print("‚ùé enter editor/place objects",5,100,col2)
	print("üÖæÔ∏è play/pause",5,108,col2)
end

function creategrid()
	local g={}
	for x=0,size do
		g[x]={}
		for y=0,size do
			g[x][y]=0
		end
	end
	return g
end

function populategrid(_g)
	for x=0,size do
		for y=0,size do
			_g[x][y]=flr(rnd(2))
		end
	end
end

function updategrid()
	local newgrid=creategrid()
	for x=1,size-1 do
		for y=1,size-1 do
			local total=grid[x-1][y-1]
			total+=grid[x][y-1]
			total+=grid[x+1][y-1]
			total+=grid[x-1][y]
			total+=grid[x+1][y]
			total+=grid[x-1][y+1]
			total+=grid[x][y+1]
			total+=grid[x+1][y+1]

			if total==2 and grid[x][y]==1 then
				newgrid[x][y]=1
			elseif total==3 then
				newgrid[x][y]=1
			else
				newgrid[x][y]=0
			end
		end
	end
	grid=newgrid
end

function drawgrid()
	for x=0,size do
		for y=0,size do
			if grid[x][y]==0 then
				rectfill(x*blocksize,y*blocksize,(x+1)*blocksize-1,(y+1)*blocksize-1,col1)
			else
				rectfill(x*blocksize,y*blocksize,(x+1)*blocksize-1,(y+1)*blocksize-1,col2)
			end
		end
	end
end

function draweditor()
	drawgrid()
	-- draw cursor
	rectfill((cur.x-1)*blocksize,cur.y*blocksize,cur.x*blocksize-1,(cur.y+1)*blocksize-1,col2)
	rectfill((cur.x+1)*blocksize,cur.y*blocksize,(cur.x+2)*blocksize-1,(cur.y+1)*blocksize-1,col2)
	rectfill((cur.x)*blocksize,(cur.y-1)*blocksize,(cur.x+1)*blocksize-1,cur.y*blocksize-1,col2)
	rectfill((cur.x)*blocksize,(cur.y+1)*blocksize,(cur.x+1)*blocksize-1,(cur.y+2)*blocksize-1,col2)
end

function _update()
	t+=1
	if state==0 then
		if menu_ptr==2 then
			if btnp(0) then
				col2=(col2-1)%16
			elseif btnp(1) then
				col2=(col2+1)%16
			end
		elseif menu_ptr==3 then
			if btnp(0) then
				col1=(col1-1)%16
			elseif btnp(1) then
				col1=(col1+1)%16
			end
		end
	
		if btnp(2) then
			menu_ptr=(menu_ptr-1)%4
		elseif btnp(3) then
			menu_ptr=(menu_ptr+1)%4
		end

		if btnp(5) then
			if menu_ptr==0 then	
				state=1
				populategrid(grid)
			elseif menu_ptr==1 then
				state=2
				grid=creategrid()
			end
		end
	elseif state==1 then
		if t%5==0 then
			updategrid()
		end
		if btnp(4) or btnp(5) then
			state=2
		end
	elseif state==2 then
		if btnp(0) then
			cur.x=mid(0,cur.x-1,size)
		elseif btnp(1) then
			cur.x=mid(0,cur.x+1,size)
		end
		
		if btnp(2) then
			cur.y=mid(0,cur.y-1,size)
		elseif btnp(3) then
			cur.y=mid(0,cur.y+1,size)
		end
		
		if btnp(4) then
			state=1
		end
		
		if btnp(5) then
			grid[cur.x][cur.y]=abs(grid[cur.x][cur.y]-1)
		end
	end
end

function _draw()
	if state==0 then
		titlescreen()
	elseif state==1 then
		drawgrid()
	elseif state==2 then
		draweditor()
	end
end
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaa0000000000aaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaa0000000000aaaa000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000aaaa000000aaaa00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000aaaa000000aaaa00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aa0000aa00aa00aa00aa0000aa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aa0000aa00aa00aa00aa0000aa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaa00aaaa00aaaa00aaaaaa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaa00aaaa00aaaa00aaaaaa00000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aa00aa00aa00aa00aa00aa0000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aa00aa00aa00aa00aa00aa0000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaaaa000000aaaaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaaaa000000aaaaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaaaa000000aaaaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaaaa000000aaaaaa000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aa00aa00aa00aa00aa00aa0000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000aa00aa00aa00aa00aa00aa0000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaa00aaaa00aaaa00aaaaaa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aaaaaa00aaaa00aaaa00aaaaaa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aa0000aa00aa00aa00aa0000aa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000aa0000aa00aa00aa00aa0000aa00000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000aaaa000000aaaa00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000aaaa000000aaaa00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaa0000000000aaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000aaaa0000000000aaaa000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000aa00aa000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000aa00aa000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

